[20251024_185144.jpg](/image/20251024_185144.jpg)
# 目的
多視点の三角測量は3Dヴィジョンコンピューティングで主流ではあるが、以下の2つの欠点があると思う。
- アウトライアの出現
- 特徴点の少ない連続面(特に地面)については多視点からの測量に向かない。
　そこで、これらを補うために自分のAndroidを改造して連続面の3次元データを集めるシステムを作ってみている。
## 仕組み(大枠)
- Androidの画面をCanvasで画素単位で照らす。
- その光が地面に当たるのをインカメで撮影
- 画素とインカメの物理的距離と、カメラ座標から画面から照らされた地面との距離とを計算する。
この前提に、Androidで画素から発される光は法線方向に絞り出さなければならない。
ただし、市販のスマホ用の覗き見防止シートは視野角が60~120°であり、これらは前提に満たないのでより狭視野角のものを探している。
株式会社信越ポリマーに視野角が20°の超狭視野角ののシートを見つけたのでそれが今欲しい状態だ。(SN-VCF)
## システムの仕組み(中枠)※⭕️はコード実装ずみ

- Arduino IDEでエンコーダから距離を推定。
  - 17rpm高トルクモータ パルスの平均から速度を求めてUSBでシリアル接続をする(⭕️)
  - スマホからはモータの速度を要求されるので、PWM制御をする。(⭕️)
    モータドライバもついてるので、逆転も可能。
  - (やるかもしれない)カメラをつけて2視点三角測量をするかもしれない。()
  三角測量の短所は目印がないと何も始まらないところだと思う。ただ地面だけを見てるから今のところ実装しないかも。
- Android側
  - Arduino IDEからの両輪の速度情報を受信()
  - ARカメラの姿勢、重力、地磁気センサからベクトル取得(⭕️)
  - 最尤推定でマハラノビス距離を最小化するように回転行列Rを計算(⭕️)
  - Canvasで常に北を向く白格子GUI(⭕️)
  - ２次元DTW法により前後のフレームの点列と類似するように点を対応づける。()
  - 画像処理にはC++を用いるためにAndroid NDKを使う。
    - LOGフィルタとゼロ交差によってエッジを検出する。(⭕️)
    - 骨格化で格子点のカメラ座標を検出する。()
- クラウド側(AWS)※詳しくはCanSatリポジトリに書いてある。
  - API Gateway > Lambda > S3でひとまず実装データを保存(⭕️)
  - S3からのセンサのデータをSagemakerで機械学習(⭕️)
 
# 数学的思い入れ
- エンコーダのパルスと重力センサと地磁気センサのサンプルレートが早い（高い？）ので線形近似でリー代数としての性質を用いる。
- 2次元のDTW法で対応する点の組み合わせを探る。
- 覗き見防止フィルタを買う場合はLOGフィルタを改正する予定
# リファレンス
- 3次元回転 金谷健一
- 3次元コンピュータヴィジョン計算ハンドブック 金谷健一,菅谷保之,金澤靖
- 実践画像処理入門 内村圭一・上瀧剛
